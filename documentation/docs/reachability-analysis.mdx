---
sidebar_position: 5
---

# Reachability Analysis

depscan can perform reachability analysis for Java, JavaScript, TypeScript, and Python with built-in support for parsing [atom](https://github.com/AppThreat/atom) reachables slices.

## Our approach

There are many ways to perform reachability analysis. Most tools—including commercial ones—rely on a vulnerability database with affected modules (sinks) to detect reachable flows.

This has several downsides:

1. These databases are often incomplete and manually maintained.
2. If a CVE or ADP enhancement isn’t available yet, reachability won’t be detected.

In contrast, depscan computes reachable flows (via atom) without relying on vulnerability data upfront. It then identifies a smaller subset of those flows that are actually vulnerable. From there, we can further narrow it down to flows that are Endpoint-Reachable, Exploitable, Container-Escapable, etc.

## Getting started

Simply invoke depscan with the `research` profile and language type to enable this feature.

To receive a verbose output including the reachable flows, pass the argument `--explain`

```shell
--profile research -t language [--explain]
```

## Example analysis for a Java project

```shell
depscan --profile research -t java -i <source directory> --reports-dir <reports directory> --explain
```

## Example analysis for a JavaScript project

```shell
depscan --profile research -t js -i <source directory> --reports-dir <reports directory> --explain
```

## Example analysis for a PHP project

Ensure PHP > 7.4 is installed. However, we support scanning PHP 5.2 - 8.3. Alternatively, use the depscan container image.

```shell
depscan --profile research -t php -i <source directory> --reports-dir <reports directory> --explain
```

## Customize the Reachability Analyzer

depscan supports two different reachability analyzers with `FrameworkReachability` being the default:

- **FrameworkReachability**: The Framework-Forward Reachability (FFR) algorithm computes reachability by identifying sources or entry points originating from framework-provided inputs or routes that reach a library sink.
- **SemanticReachability**: The Semantic Reachability algorithm builds on Framework-Forward Reachability by incorporating endpoint and service information to better prioritize vulnerabilities.

Pass the argument `--reachability-analyzer SemanticReachability` to use the Semantic Reachability analyzer.

SemanticReachability achieves optimal results when supplemented with comprehensive data, including BOM files from multiple project types, various life cycle stages, container SBOMs, atom slices (reachables and usages), and openapi specification files. Since depscan cannot automatically generate all required BOMs, it is recommended to build the project and container images, manually generate the necessary BOM files, and then execute depscan using the `--bom-dir` argument.

### Example semantic reachability analysis for a Java project

```shell
depscan -t java -i <source directory> --reports-dir <reports directory> --reachability-analyzer SemanticReachability --explain
```

### Example semantic reachability analysis for a JavaScript project

```shell
depscan -t js -i <source directory> --reports-dir <reports directory> --reachability-analyzer SemanticReachability --explain
```

### Example semantic reachability analysis for an existing BOM directory (Recommended)

```shell
depscan --bom-dir <bom directory> --reports-dir <reports directory> --reachability-analyzer SemanticReachability --explain
```

This is the recommended invocation style for a thorough semantic analysis.

## Explainability

Pass the --explain argument to get a detailed explanation of the analysis performed by depscan.

### Explanation Mode

When SemanticReachability is enabled and the `--explanation-mode` argument is provided, the explanation style can be customized. depscan supports three explanation styles:

1.	**Endpoints** – Lists all HTTP endpoints, their methods, and code hotspots detected through static analysis.
2.	**EndpointsAndReachables** – Includes endpoints along with a selection of up to 20 reachable data flows, providing detailed explanations. This is the default.
3.	**NonReachables** – Highlights up to 20 non-reachable data flows, useful for showcasing areas where validation and sanitization are properly implemented.

```shell
depscan --bom-dir <bom directory> --reports-dir <reports directory> --reachability-analyzer SemanticReachability --explain --explanation-mode NonReachables
```

Use the environment variable `MAX_REACHABLE_EXPLANATIONS` to customize the number of data-flow explanations.
